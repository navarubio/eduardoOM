<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
        <script src="../recursos/js/calendario.js"/>
        <link href="../recursos/css/estilos.css" rel="stylesheet"/>
        <link href="../recursos/css/metro-bootstrap.css" rel="stylesheet"/>
        <link href="../recursos/css/iconFont.css" rel="stylesheet"/>        
    </h:head>
    <h:body>
        <p:growl id="msgbAdmision" autoUpdate="true" showDetail="true"/> 
        <br/>        
        <div>
            #{consultaMB.inicializar()}
            <div class="text-left">
                <p:outputLabel style="font-size: 150%" value="Fecha:"/>
                <p:calendar size="11" value="#{admisionMB.fecha}"
                            pattern="dd/MM/yyyy" /> 
                <p:calendar size="7" value="#{admisionMB.hora}"
                            pattern="HH:mm:ss" /> 
            </div>
            <div class="text-right">
                <p:outputLabel style="font-size: 150%" value="#{loginMB.usuarioActual.cargoActual}"/> :
                <p:outputLabel style="font-style: italic;font-size: 150%" value="#{loginMB.usuarioActual.nombreCompleto()}"/>
            </div>
        </div>
        <h:form id="formAdmision">

            <!-- SELECCION DEL PACIENTE -->                    
            <p:fieldset legend="Consultar Registro Paciente">
                <table>
                    <tr>
                        <td>
                            <p:outputLabel styleClass="labelFormularioBold" id="idtipodocumento" value="#{admisionMB.pacienteSeleccionado.tipoIdentificacion.descripcion}" rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}"/>
                            <p:inputText  styleClass="campoFormulario"  id="iddocumento" size="25" value="#{admisionMB.identificacion}" >
                                <p:ajax event="blur" listener="#{admisionMB.findPaciente}" 
                                        update=":msgbAdmision :formAdmision:idfieldsetdatosPaciente :formAdmision:IdTabView :formAdmision:idfieldsetRegistroPaciente :formAdmision "/>
                            </p:inputText>
                            <p:watermark for="iddocumento" value="Identificación paciente"/>
                            <p:commandButton
                                id="cbtnPaciente"
                                styleClass="campoFormulario"
                                title="Paciente"
                                onclick="PF('dlgPaciente').show();"
                                icon="ui-icon-search"
                                style="width: 23px; height: 23px;"/>                                
                        </td>       
                    </tr>

                </table>
            </p:fieldset>

            <p:fieldset id="idfieldsetdatosPaciente" legend="Datos del Paciente" rendered="#{admisionMB.pacienteSeleccionado.idPaciente eq null ? false : true}"  > 
                <table style="margin-left: auto; margin-right: auto;">
                    <tr>
                        <td>
                            <p:graphicImage id="IdFoto" url="#{admisionMB.urlFoto}" cache="false" width="80" height="70" rendered="#{admisionMB.pacienteSeleccionado.idPaciente!=null}"/>                              
                        </td>
                        <td>
                            <table>
                                <tr>
                                    <td>

                                        <p:outputLabel styleClass="labelFormularioBold" value="Paciente:" rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}" />
                                        <p:outputLabel styleClass="labelFormulario" id="idpaciente" value="#{admisionMB.pacienteSeleccionado.primerNombre} #{admisionMB.pacienteSeleccionado.segundoNombre}
                                                       #{admisionMB.pacienteSeleccionado.primerApellido} #{admisionMB.pacienteSeleccionado.segundoApellido}" rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}"/>
                                        <p:outputLabel styleClass="labelFormularioBold" value="Género:" rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}"/>
                                        <p:outputLabel styleClass="labelFormulario" id="idsexo" value="#{admisionMB.pacienteSeleccionado.genero.observacion}" rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}"/>
                                        <p:outputLabel styleClass="labelFormularioBold" value="Fecha Nacimiento:" rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}"/>
                                        <p:outputLabel styleClass="labelFormulario"  id="idfecnac" value="#{admisionMB.pacienteSeleccionado.fechaNacimiento}" rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}">
                                            <f:convertDateTime locale="es_CO" pattern="MM/dd/yyyy"/>   
                                        </p:outputLabel>                                       
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <p:outputLabel styleClass="labelFormularioBold" value="Edad:" rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}"/>
                                        <p:outputLabel styleClass="labelFormularioBold" value="#{admisionMB.calcularEdadInt(admisionMB.pacienteSeleccionado.fechaNacimiento)}"/>                                  
                                        <p:outputLabel styleClass="labelFormularioBold" value="G.S. RH:" rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}"/>
                                        <p:outputLabel  styleClass="labelFormulario" id="idrh" value="#{admisionMB.pacienteSeleccionado.grupoSanguineo.descripcion}" rendered="#{admisionMB.pacienteSeleccionado.idPaciente!=null}"/>
                                        <p:outputLabel styleClass="labelFormularioBold" value="Estado Civil:" rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}"/>
                                        <p:outputLabel  styleClass="labelFormulario" id="idecivil" value="#{admisionMB.pacienteSeleccionado.estadoCivil.descripcion}" rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}"/>
                                        <p:outputLabel styleClass="labelFormularioBold" value="Lugar Nacimiento:" rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}"/>
                                        <p:outputLabel styleClass="labelFormulario" id="idlugnac"  value="#{admisionMB.pacienteSeleccionado.municipio.descripcion} #{admisionMB.pacienteSeleccionado.departamento.descripcion}" 
                                                       rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <p:outputLabel styleClass="labelFormularioBold" value="Teléfono:" rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}"/>
                                        <p:outputLabel styleClass="labelFormulario" id="idtel" value="#{admisionMB.pacienteSeleccionado.telefonoResidencia}" rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}"/>
                                        <p:outputLabel styleClass="labelFormularioBold" value="Dirección:" rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}"/>
                                        <p:outputLabel  styleClass="labelFormulario" id="iddir" value="#{admisionMB.pacienteSeleccionado.direccion}" rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}"/>
                                        <p:outputLabel styleClass="labelFormularioBold" value="Administradora:" rendered="#{admisionMB.pacienteSeleccionado.idPaciente!=null}"/>
                                        <p:outputLabel styleClass="labelFormulario" id="idadministradora" value="#{admisionMB.pacienteSeleccionado.idAdministradora.razonSocial}" rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}"/>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
                <br></br>
            </p:fieldset>
            <p:fieldset rendered="#{admisionMB.nuevoRegistroPaciente}" legend="Registro Nuevo Paciente" id="idfieldsetRegistroPaciente">
                <div>
                    <p:commandButton 
                        title="Actualizar paciente" value="&nbsp;" 
                        rendered="#{admisionMB.pacienteSeleccionado.idPaciente !=null}"
                        styleClass="icon-floppy fg-lightBlue bg-white no-border" validateClient="true"
                        update=":msgbAdmision :formAdmision:idfieldsetdatosPaciente :formAdmision:idfieldsetRegistroPaciente :formAdmision:tableElegirPaciente :formAdmision"
                        actionListener="#{admisionMB.actualizarPaciente()}"                    
                        style="font-size: 20px; width: 20px; height: 20px; left: 20px; "/>                            
                    &nbsp;
                    <p:commandButton 
                        title="Guardar paciente" value="&nbsp;" rendered="#{admisionMB.pacienteSeleccionado.idPaciente ==null}"
                        styleClass="icon-floppy fg-lightBlue bg-white no-border" validateClient="true"
                        update=":msgbAdmision :formAdmision:idfieldsetdatosPaciente :formAdmision:idfieldsetRegistroPaciente :formAdmision:tableElegirPaciente :formAdmision"
                        actionListener="#{admisionMB.guardarPaciente}"                    
                        style="font-size: 20px; width: 20px; height: 20px; left: 20px; "/>                            
                    &nbsp;
                    <p:commandButton 
                        title="Cancelar" value="&nbsp;"                                   
                        actionListener="#{admisionMB.cancelar()}"                    
                        update=":formAdmision:idfieldsetdatosPaciente :formAdmision:idfieldsetRegistroPaciente :formAdmision:tableElegirPaciente :formAdmision"
                        style="font-size: 20px; width: 20px; height: 20px; left: 20px; "/> 
                    &nbsp;
                </div>
                <br/>        
                <p:tabView style=" width: 99%;" activeIndex="#{pacientesMB.tabActivaPacientes}" id="IdTabView" > 
                    <p:tab rendered="#{admisionMB.pacienteSeleccionado.idPaciente ==null}" title="#{admisionMB.tituloTabPacientes}">  
                        <table style="margin: 20px; margin-left: auto; margin-right: auto;">
                            <tr>
                                <td style="vertical-align: top;">
                                    <div style="width: 90px; ">
                                        <p:graphicImage id="IdFoto" url="#{admisionMB.urlFoto}" cache="false" style="width: 80px; height: 70px;"/>                              
                                        <p:commandButton id="cmdUpload" value="&nbsp;" icon="ui-icon-folder-open" onclick="PF('dlgUploadFoto').show()" type="button" title="Upload archivo foto" />
                                        <p:commandButton id="cmdWebCam" value="&nbsp;" icon="ui-icon-video" onclick="PF('dlgWebCam').show()" type="button" title="Webcam"/>                                                                                                
                                        <p:dialog id="webcam" widgetVar="dlgWebCam" modal="true" dynamic="true" resizable="false" showHeader="false" closable="false" >
                                            <p:photoCam widgetVar="pcPhoto" listener="#{admisionMB.tomarFoto}" update="IdFoto"/>
                                            <br/>
                                            <p:commandButton type="button" value="Tomar" onclick="PF('pcPhoto').capture()" update="IdFoto" onsuccess="PF('dlgWebCam').hide()"/>
                                            <p:commandButton type="button" value="Cerrar" onclick="PF('dlgWebCam').hide()"/>                            
                                        </p:dialog>
                                        <p:dialog id="upload1" widgetVar="dlgUploadFoto" modal="true" dynamic="true" resizable="false" showHeader="false" closable="false" >
                                            <p:fileUpload 
                                                fileUploadListener="#{admisionMB.uploadFoto}" sizeLimit="5000000" auto="true"
                                                update="IdFoto" allowTypes="/(\.|\/)(gif|jpe?g|png)$/" oncomplete="dlgUpload.hide();"
                                                mode="advanced" label="Selecionar" uploadLabel="Enviar" cancelLabel="Cancelar" />                            
                                            <br/>
                                            <br/>
                                            <p:commandButton type="button" value="Cerrar" onclick="PF('dlgUploadFoto').hide()"/>
                                        </p:dialog>
                                        <br/><br/>
                                        <p:graphicImage id="IdFirma" url="#{admisionMB.urlFirma}" cache="false" style="width: 80px; height: 40px;"/>
                                        <p:commandButton id="cmdUploadFirma" value="&nbsp;" icon="ui-icon-folder-open" onclick="PF('dlgUploadFirma').show()" type="button" title="Upload Archivo firma" />
                                        <p:dialog id="upload2" widgetVar="dlgUploadFirma" modal="true" dynamic="true" resizable="false" showHeader="false" closable="false" >
                                            <p:fileUpload 
                                                fileUploadListener="#{admisionMB.uploadFirma}" sizeLimit="5000000" auto="true"
                                                update="IdFirma" allowTypes="/(\.|\/)(gif|jpe?g|png)$/" oncomplete="dlgUpload.hide();"
                                                mode="advanced" label="Selecionar" uploadLabel="Enviar" cancelLabel="Cancelar"/>                            
                                            <br/>
                                            <p:commandButton type="button" value="Cerrar" onclick="PF('dlgUploadFirma').hide()"/>
                                        </p:dialog>
                                    </div>
                                </td>                        
                                <td style="vertical-align: top;">
                                    <table >
                                        <tr>                           
                                            <td>
                                                <p:outputLabel   styleClass="campoObligatorio" value="Tipo Identificación"/>
                                                <p:selectOneMenu styleClass="campoFormulario" style="width: 80px;" value="#{admisionMB.tipoIdentificacion}">                                    
                                                    <f:selectItems value="#{aplicacionGeneralMB.listaTipoIdentificacion}" />
                                                </p:selectOneMenu>                                         
                                                <p:outputLabel   styleClass="campoNoObligatorio" value="Lugar expedición"/>
                                                <p:inputText     styleClass="campoFormulario" size="16" value="#{admisionMB.lugarExpedicion}"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p:outputLabel   styleClass="campoNoObligatorio" value="Fec. Nacimiento"/>
                                                <p:calendar styleClass="campoFormulario" navigator="true" mask="true" locale="es" pattern="dd/MM/yyyy" value="#{admisionMB.fechaNacimiento}" size="14">
                                                </p:calendar>
                                                <p:outputLabel   styleClass="campoObligatorio" value="Género"/>
                                                <p:selectOneMenu styleClass="campoFormulario" style="width: 150px;" value="#{admisionMB.genero}">                                    
                                                    <f:selectItems value="#{aplicacionGeneralMB.listaGenero}" />
                                                </p:selectOneMenu>
                                                <p:outputLabel   styleClass="campoNoObligatorio" value="RH"/> 
                                                <p:selectOneMenu styleClass="campoFormulario" style="width: 100px;" value="#{admisionMB.grupoSanguineo}">                                                    
                                                    <f:selectItems value="#{aplicacionGeneralMB.listaGrupoSanguineo}" />
                                                </p:selectOneMenu>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>   
                                                <p:outputLabel styleClass="campoObligatorio" value="Nombres"/>
                                                <p:inputText styleClass="campoFormulario" size="19" maxlength="15" value="#{admisionMB.primerNombre}" />
                                                <p:inputText styleClass="campoFormulario" size="19" value="#{admisionMB.segundoNombre}"/>
                                                <p:outputLabel styleClass="campoObligatorio" value="Apellidos"/>                                            
                                                <p:inputText styleClass="campoFormulario" size="18" maxlength="15" value="#{admisionMB.primerApellido}"/>
                                                <p:inputText styleClass="campoFormulario" size="18" value="#{admisionMB.segundoApellido}"/>

                                            </td>
                                        </tr>
                                        <tr>
                                            <td> 
                                                <p:outputLabel   styleClass="campoNoObligatorio" value="Ocupación"/>
                                                <p:selectOneMenu styleClass="campoFormulario" style="width: 352px;" value="#{admisionMB.ocupacion}" filter="true" filterMatchMode="contains">
                                                    <f:selectItem itemLabel="" itemValue=""/>
                                                    <f:selectItems value="#{aplicacionGeneralMB.listaOcupaciones}" class="width1" />
                                                </p:selectOneMenu>
                                                <p:outputLabel   styleClass="campoNoObligatorio" value="Estado civil"/> 
                                                <p:selectOneMenu styleClass="campoFormulario" style="width: 130px;" value="#{admisionMB.estadoCivil}">
                                                    <f:selectItem itemLabel="" itemValue=""/>
                                                    <f:selectItems value="#{aplicacionGeneralMB.listaEstadoCivil}" />
                                                </p:selectOneMenu>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>   
                                                <p:outputLabel   styleClass="campoNoObligatorio" value="Tel. residencia"/>
                                                <p:inputText     styleClass="campoFormulario" value="#{admisionMB.telefonoResidencia}" size="24"/>
                                                <p:outputLabel   styleClass="campoNoObligatorio" value="Tel. oficina"/>
                                                <p:inputText     styleClass="campoFormulario" value="#{admisionMB.telefonoOficina}" size="21"/>
                                                <p:outputLabel   styleClass="campoNoObligatorio" value="Celular"/> 
                                                <p:inputText     styleClass="campoFormulario" value="#{admisionMB.celular}" size="20"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>   
                                                <p:outputLabel   styleClass="campoNoObligatorio" value="Departamento"/>
                                                <p:selectOneMenu styleClass="campoFormulario" style="width: 150px;" value="#{admisionMB.departamento}" filter="true" filterMatchMode="contains">
                                                    <f:ajax 
                                                        event="change"
                                                        listener="#{admisionMB.cargarMunicipios}"                                                
                                                        render="IdMunicipios"/> 
                                                    <f:selectItem itemLabel="" itemValue=""/>
                                                    <f:selectItems value="#{aplicacionGeneralMB.listaDepartamentos}" />
                                                </p:selectOneMenu>
                                                <p:outputLabel     styleClass="campoNoObligatorio" value="Municipio"/>
                                                <p:selectOneMenu   styleClass="campoFormulario" id="IdMunicipios" style="width: 140px;" value="#{admisionMB.municipio}" filter="true" filterMatchMode="contains">
                                                    <f:selectItems value="#{admisionMB.listaMunicipios}" />
                                                </p:selectOneMenu>
                                                <p:outputLabel   styleClass="campoObligatorio" value="Zona"/>
                                                <p:selectOneMenu styleClass="campoFormulario" style="width: 125px;" value="#{admisionMB.zona}">                                    
                                                    <f:selectItems value="#{aplicacionGeneralMB.listaZona}" />
                                                </p:selectOneMenu>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p:outputLabel     styleClass="campoNoObligatorio" value="Barrio"/>                                                
                                                <p:inputText       styleClass="campoFormulario" value="#{admisionMB.barrio}" size="37"/>                                
                                                <p:outputLabel   styleClass="campoNoObligatorio" value="Dirección"/> 
                                                <p:inputText     styleClass="campoFormulario" value="#{admisionMB.direccion}" size="56"/>
                                            </td>
                                        </tr>                                    
                                        <tr>
                                            <td>  
                                                <p:outputLabel     styleClass="campoNoObligatorio" value="Email"/>                                                
                                                <p:inputText       styleClass="campoFormulario" value="#{admisionMB.email}" size="89"/>  
                                                <p:outputLabel   styleClass="campoNoObligatorio" value="Paciente Activo"/>
                                                <p:selectBooleanCheckbox styleClass="campoFormulario" disabled="true" value="#{admisionMB.activo}"/>
                                            </td>
                                        </tr>
                                    </table> 
                                </td>
                            </tr>
                        </table>
                    </p:tab>
                    <p:tab title="Datos adicionales">  
                        <table style="margin: 20px; margin-left: auto; margin-right: auto;">
                            <tr>
                                <td> 
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Administradora"/> 
                                    <p:selectOneMenu styleClass="campoFormulario" style="width: 330px;" value="#{admisionMB.administradora}">
                                        <f:selectItem itemLabel="" itemValue=""/>
                                        <f:selectItems value="#{aplicacionGeneralMB.listaAdministradoras}" var="administradora" itemLabel="#{administradora.razonSocial}" itemValue="#{administradora.idAdministradora}" />
                                    </p:selectOneMenu>
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Tipo afiliado"/> 
                                    <p:selectOneMenu styleClass="campoFormulario" style="width: 220px;" value="#{admisionMB.tipoAfiliado}">
                                        <f:selectItem itemLabel="" itemValue=""/>
                                        <f:selectItems value="#{aplicacionGeneralMB.listaTipoAfiliado}" />
                                    </p:selectOneMenu> 
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Régimen"/>
                                    <p:selectOneMenu styleClass="campoFormulario" style="width: 233px;" value="#{admisionMB.regimen}">
                                        <f:selectItem itemLabel="" itemValue=""/>
                                        <f:selectItems value="#{aplicacionGeneralMB.listaRegimen}" />
                                    </p:selectOneMenu>
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Categoria"/> 
                                    <p:selectOneMenu styleClass="campoFormulario" style="width: 195px;" value="#{admisionMB.categoriaPaciente}">
                                        <f:selectItem itemLabel="" itemValue=""/>
                                        <f:selectItems value="#{aplicacionGeneralMB.listaCategoriaPaciente}" />
                                    </p:selectOneMenu>
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Estrato"/>
                                    <p:selectOneMenu styleClass="campoFormulario" style="width: 120px;" value="#{admisionMB.estrato}">
                                        <f:selectItem itemLabel="" itemValue=""/>
                                        <f:selectItems value="#{aplicacionGeneralMB.listaEstrato}" />
                                    </p:selectOneMenu>                                
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Etnia"/> 
                                    <p:selectOneMenu styleClass="campoFormulario" style="width: 170px;" value="#{admisionMB.etnia}">
                                        <f:selectItem itemLabel="" itemValue=""/>
                                        <f:selectItems value="#{aplicacionGeneralMB.listaEtnia}" />
                                    </p:selectOneMenu>
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Escolaridad"/> 
                                    <p:selectOneMenu styleClass="campoFormulario" style="width: 193px;" value="#{admisionMB.escolaridad}">
                                        <f:selectItem itemLabel="" itemValue=""/>
                                        <f:selectItems value="#{aplicacionGeneralMB.listaEscolaridad}" />
                                    </p:selectOneMenu>
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Numero autorización"/> 
                                    <p:inputText     styleClass="campoFormulario" value="#{admisionMB.numeroAutorizacion}" size="18"/>
                                </td>
                            </tr>
                            <tr>
                                <td>  
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Responsable"/>
                                    <p:inputText     styleClass="campoFormulario" value="#{admisionMB.responsable}" size="35"/>
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Tel. Responsable" />
                                    <p:inputText     styleClass="campoFormulario" value="#{admisionMB.telefonoResponsable}" size="12"/>
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Parentesco" />
                                    <p:selectOneMenu styleClass="campoFormulario" style="width: 175px;" value="#{admisionMB.parentesco}" filter="true" filterMatchMode="contains">
                                        <f:selectItem itemLabel="" itemValue=""/>
                                        <f:selectItems value="#{aplicacionGeneralMB.listaParentesco}" />
                                    </p:selectOneMenu>                                
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Acudiente"/>
                                    <p:inputText     styleClass="campoFormulario" value="#{admisionMB.acompanante}" size="34"/>
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Tel. acudiente" />
                                    <p:inputText     styleClass="campoFormulario" value="#{admisionMB.telefonoAcompanante}" size="12"/>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Fec. Afiliación"/>
                                    <p:calendar      styleClass="campoFormulario"    navigator="true" locale="es" pattern="dd/MM/yyyy" mask="true" size="10" value="#{admisionMB.fechaAfiliacion}"/>
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Fec. sisben" />
                                    <p:calendar      styleClass="campoFormulario"    navigator="true" locale="es" pattern="dd/MM/yyyy" mask="true" size="10" value="#{admisionMB.fechaSisben}"/>                            
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Carnet" />
                                    <p:inputText     styleClass="campoFormulario"    value="#{admisionMB.carnet}" size="26"/>
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Vencimiento carnet  " />
                                    <p:calendar      styleClass="campoFormulario"    navigator="true" locale="es" pattern="dd/MM/yyyy" mask="true" size="10" value="#{admisionMB.fechaVenceCarnet}"/>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Discapacidad"/>
                                    <p:selectOneMenu styleClass="campoFormulario" style="width: 175px;" value="#{admisionMB.discapacidad}" filter="true" filterMatchMode="contains">
                                        <f:selectItem itemLabel="" itemValue=""/>
                                        <f:selectItems value="#{aplicacionGeneralMB.listaDiscapacidad}" />
                                    </p:selectOneMenu>   
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Gestación"/>
                                    <p:selectOneMenu styleClass="campoFormulario" style="width: 175px;" value="#{admisionMB.gestacion}" filter="true" filterMatchMode="contains">
                                        <f:selectItem itemLabel="" itemValue=""/>
                                        <f:selectItems value="#{aplicacionGeneralMB.listaGestacion}" />
                                    </p:selectOneMenu>   
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Religion"/>
                                    <p:selectOneMenu styleClass="campoFormulario" style="width: 175px;" value="#{admisionMB.religion}" filter="true" filterMatchMode="contains">
                                        <f:selectItem itemLabel="" itemValue=""/>
                                        <f:selectItems value="#{aplicacionGeneralMB.listaReligion}" />
                                    </p:selectOneMenu>   
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Víctima de conflicto armado"/>
                                    <p:selectBooleanCheckbox styleClass="campoFormulario" value="#{admisionMB.victimaConflicto}"/> 
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Población LBGT"/>
                                    <p:selectBooleanCheckbox styleClass="campoFormulario" value="#{admisionMB.poblacionLBGT}"/> 
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Desplazado"/>
                                    <p:selectBooleanCheckbox styleClass="campoFormulario" value="#{admisionMB.desplazado}"/> 
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Víctima de maltrato"/>
                                    <p:selectBooleanCheckbox styleClass="campoFormulario" value="#{admisionMB.victimaMaltrato}"/> 
                                </td>
                            </tr>
                            <tr>
                                <td> 
                                    <p:outputLabel   styleClass="campoNoObligatorio" value="Observaciones"/>
                                    <p:inputTextarea value="#{admisionMB.observaciones}" style="width: 633px;"/>
                                </td>       
                            </tr>
                        </table>
                    </p:tab>
                </p:tabView>               
                <br></br>
            </p:fieldset>
            <br></br>
            <div style="text-align: center">
                <p:commandButton 
                    rendered="#{admisionMB.pacienteSeleccionado.idPaciente != null and admisionMB.pacienteSeleccionado.idAdministradora.idAdministradora != null}"
                    id="cbtnAgregarPaciente"
                    value="Admitir Paciente" 
                    update = ":formAdmision :formAdmision:tableElegirPaciente"
                    actionListener="#{admisionMB.guardarAdmisionPaciente()}"
                    icon="ui-icon-disk"/>

                <p:commandButton 
                    rendered="#{admisionMB.pacienteSeleccionado.idPaciente != null and admisionMB.pacienteSeleccionado.idAdministradora.idAdministradora != null}"
                    id="cbtCancelar"
                    value="Cancelar admisión" 
                    update = ":formAdmision"
                    actionListener="#{admisionMB.limpiarFormulario()}"
                    icon="icon-new fg-lightBlue bg-white no-border"/>
            </div>
            <!-- LISTADO DE PACIENTES ADMITIDOS-->
            <br></br>
            <p:fieldset legend="Listado de Pacientes admitidos">
                <table>  
                    <tr>
                        <td>
                            <p:dataTable
                                id="tableElegirPaciente"
                                var="admision" 
                                value="#{admisionMB.listaAdmisionesPaciente}"
                                paginator="true"
                                rows="10"
                                lazy="true"
                                paginatorPosition="bottom"                                
                                emptyMessage="No se encontraron pacientes admitidos"
                                scrollable="true" 
                                pageLinks="5"
                                widgetVar="tableElegirPaciente"
                                resizableColumns="true"
                                >
                                <p:column headerText="NRO.ADMISION" width="25%" filterBy="#{admision.nroAdmision}" filterMatchMode="contains" filterStyle="width: 145px;">
                                    <h:outputText value="#{admision.nroAdmision}"/>                                  
                                </p:column>
                                <p:column headerText="IDENTIFICACION" width="24%" filterBy="#{admision.idPaciente.identificacion}" filterMatchMode="contains" filterStyle="width: 145px;">
                                    <h:outputText value="#{admision.idPaciente.identificacion}"/>                                  
                                </p:column>
                                <p:column headerText="PACIENTE" width="44%" filterBy="#{admision.idPaciente.primerNombre} #{admision.idPaciente.segundoNombre} #{admision.idPaciente.primerApellido} #{admision.idPaciente.segundoApellido}" filterStyle="width: 250px;" filterMatchMode="contains">
                                    <h:outputText value="#{admision.idPaciente.primerNombre} #{admision.idPaciente.segundoNombre} #{admision.idPaciente.primerApellido} #{admision.idPaciente.segundoApellido}" />
                                </p:column>
                                <p:column headerText="GENERO" filterBy="#{admision.idPaciente.genero.descripcion}" width="20%" filterMatchMode="contains" >
                                    <h:outputText value="#{admision.idPaciente.genero.descripcion}"/>                                  
                                </p:column>
                                <p:column headerText="EDAD" width="15%" filterBy="#{admision.idPaciente.edad}" filterMatchMode="contains" filterStyle="width: 145px;">
                                    <h:outputText value="#{admisionMB.calcularEdadInt(admision.idPaciente.fechaNacimiento)}"/>                                  
                                </p:column>
                                <p:column headerText="ADMINISTRADORA" width="25%" filterBy="#{admision.idPaciente.idAdministradora.nombreRepresentante}" filterStyle="width: 250px;" filterMatchMode="contains">
                                    <h:outputText value="#{admision.idPaciente.idAdministradora.nombreRepresentante}" />
                                </p:column>
                                <p:column headerText="FECHA ADMISION" width="32%" filterBy="#{admision.fechaAdmision}" filterMatchMode="contains" filterStyle="width: 145px;">
                                    <p:calendar size="10" id="datetime" value="#{admision.fechaAdmision}"
                                                pattern="dd/MM/yyyy" /> 
                                    <p:calendar size="7" value="#{admision.horaAdmision}"
                                                pattern="HH:mm:ss" /> 
                                </p:column>
                                <p:column headerText="ATENDIDO" width="25%" filterBy="#{admision.atendida}" filterMatchMode="contains" filterStyle="width: 145px;">
                                    <p:selectBooleanButton disabled="true" value="#{admision.atendida}" onLabel="Si" offLabel="No" onIcon="ui-icon-check" offIcon="ui-icon-close" style="width:70px">
                                    </p:selectBooleanButton>
                                </p:column>
                                <p:column  headerText="OPERACIONES" width="20%"  >
                                    <p:commandButton title="Pasar a triage"  process="@this" actionListener="#{admisionMB.ingresarPacienteTriage(admision)}" 
                                                     update=":formAdmision:tableElegirPaciente" icon="ui-icon-gear">
                                    </p:commandButton>
                                </p:column>
                            </p:dataTable>                                    
                        </td>
                    </tr>
                </table>
            </p:fieldset>
            <!-- SELECCION DEL PRESTADOR -->                
            <p:dialog header="Buscar Paciente" widgetVar="dlgPaciente" resizable="false" modal="true">
                <h:form id="formFindPaciente">
                    <table>
                        <tr>
                            <td colspan="3">
                                <p:dataTable
                                    id="tableElegirPaciente"
                                    var="paciente" 
                                    value="#{admisionMB.listaPacientes}"
                                    rowKey="#{paciente.idPaciente}"  
                                    selection="#{admisionMB.pacienteSeleccionadoTabla}" 
                                    paginator="true"
                                    style="width: 600px;"
                                    rows="10"
                                    lazy="true"
                                    paginatorPosition="bottom"                                
                                    emptyMessage="No se encontraron pacientes"
                                    scrollable="true" 
                                    pageLinks="5"
                                    widgetVar="pacientesTable"
                                    selectionMode="single"
                                    resizableColumns="true"
                                    >
                                    <p:column headerText="Nro Documento" width="25%" filterBy="#{paciente.identificacion}" filterMatchMode="contains" filterStyle="width: 145px;">
                                        <h:outputText value="#{paciente.identificacion}"/>                                  
                                    </p:column>
                                    <p:column headerText="Nombre" width="44%" filterBy="#{paciente.primerNombre} #{paciente.segundoNombre} #{paciente.primerApellido} #{paciente.segundoApellido}" filterStyle="width: 250px;" filterMatchMode="contains">
                                        <h:outputText value="#{paciente.primerNombre} #{paciente.segundoNombre} #{paciente.primerApellido} #{paciente.segundoApellido}" />
                                    </p:column>
                                </p:dataTable>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="3">
                                <!--
                                agregar el actionListener citasMB.loadServicios cuando los servicios dependan del contrato de la administradora, el genero, la edad y la zona del paciente
                                -->
                                <p:commandButton
                                    id="cbtnPaciente"
                                    value="Cargar Paciente"
                                    update = ":formAdmision :msgbAdmision"
                                    actionListener="#{admisionMB.cargarPaciente()}"
                                    oncomplete="PF('dlgPaciente').hide(); PF('tableElegirPaciente').clearFilters(); PF('tableElegirPaciente').getPaginator().setPage(0);"                                 
                                    />
                            </td>
                        </tr>
                    </table>
                </h:form>
            </p:dialog>
        </h:form>
    </h:body>
</html>

